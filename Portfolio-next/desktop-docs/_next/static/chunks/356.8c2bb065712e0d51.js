(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[356],{1159:e=>{e.exports={container:"WindowContainer_container__A6uBo","content-container":"WindowContainer_content-container__dOk9P",focused:"WindowContainer_focused__Gqruf",resizable:"WindowContainer_resizable__bLqVU","focus-layer":"WindowContainer_focus-layer__XmRuW",header:"WindowContainer_header__hGKJN",mobile:"WindowContainer_mobile__S38TS",lines:"WindowContainer_lines__HbTIs",content:"WindowContainer_content__Zm4uC","resizing-mask":"WindowContainer_resizing-mask__mXyBh","dragging-mask":"WindowContainer_dragging-mask__88KWa","header-title":"WindowContainer_header-title__GxSvJ","header-buttons":"WindowContainer_header-buttons__quaZm","action-overlay":"WindowContainer_action-overlay__yzLLS","action-container":"WindowContainer_action-container__ocdU9","action-buttons":"WindowContainer_action-buttons__eXP8S"}},2356:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>f});var r=n(6029),i=n(5729),s=n(1159),o=n.n(s),c=n(4893);class a{constructor(){this.cursor={x:0,y:0},this.boundingBox={top:0,left:0,width:0,height:0},this.offset={x:0,y:0},this.window={x:0,y:0,width:0,height:0}}}let u=e=>{let{windowData:t,windowCompositor:n,parent:s,isMaximized:u}=e,[d,l]=(0,i.useState)(!1),[h,f]=(0,i.useState)("auto"),w=(0,i.useRef)(!1),A=(0,i.useRef)("none"),g=(0,i.useRef)(new a),m=(0,i.useRef)(null),x=e=>{let t=m.current;if(null===t)return"none";let n=t.getBoundingClientRect(),r=30>Math.abs(e.clientX-n.left),i=30>Math.abs(e.clientX-(n.left+n.width)),s=30>Math.abs(e.clientY-n.top),o=30>Math.abs(e.clientY-(n.top+n.height));return s&&r?"nw":s&&i?"ne":o&&r?"sw":o&&i?"se":s?"n":o?"s":i?"e":r?"w":"none"},p=e=>{let n=m.current;if(null===n)return;window.addEventListener("pointerup",v),window.addEventListener("pointermove",y),w.current=!0;let r=x(e);A.current=r;let i=n.getBoundingClientRect();l(!0),u.current=!1,g.current.cursor={x:e.clientX,y:e.clientY},g.current.window={x:t.x,y:t.y,width:t.width,height:t.height};let o=t.y+s.offsetTop,c=t.x+s.offsetLeft;r.split("").forEach(e=>{switch(e){case"n":g.current.offset.y=g.current.cursor.y-o;break;case"s":g.current.offset.y=g.current.cursor.y-(o+t.height);break;case"w":g.current.offset.x=g.current.cursor.x-c;break;case"e":g.current.offset.x=g.current.cursor.x-(c+t.width)}}),g.current.boundingBox={top:i.top,left:i.left,width:i.width,height:i.height}};function v(e){window.removeEventListener("pointerup",v),window.removeEventListener("pointermove",y),w.current=!1,l(!1)}function y(e){if(!w.current)return;let r={x:t.x,y:t.y,height:t.height,width:t.width},i=t.minimalHeight,o=t.minimalWidth,a=window.innerHeight,u=window.innerWidth,d=g.current.offset.x,l=g.current.offset.y,[h,f]=[g.current.cursor.x-(0,c.qE)(e.clientX,s.offsetLeft+d,s.offsetWidth+d),g.current.cursor.y-(0,c.qE)(e.clientY,s.offsetTop+l,s.offsetTop+s.offsetHeight+l)],[m,x]=[g.current.window.x,g.current.window.y],[p,v]=[g.current.window.width,g.current.window.height];for(let e of A.current.split(""))switch(e){case"n":{let e=x+(v-i),n=Math.min(x-f,e),r=(0,c.qE)(v+f,i,a);t.y=n,t.height=r}break;case"e":t.width=(0,c.qE)(p-h,o,u);break;case"s":t.height=(0,c.qE)(v-f,i,a);break;case"w":{let e=m+(p-o),n=Math.min(m-h,e),r=(0,c.qE)(p+h,o,u);t.x=n,t.width=r}}let y=r.x!==t.x||r.y!==t.y,b=r.height!==t.height||r.width!==t.width;n.update(t,{moved:y,resized:b})}function b(e){let t=(e=>{switch(x(e)){case"none":return"none";case"e":case"w":return"ew";case"n":case"s":return"ns";case"ne":case"sw":return"nesw";case"se":case"nw":return"nwse"}})(e);if("none"===t)return void f("auto");f("".concat(t,"-resize"))}(0,i.useEffect)(()=>{let e=m.current;if(null!==e)return e.addEventListener("pointerdown",p),e.addEventListener("pointermove",b),()=>{e.removeEventListener("pointerdown",p),e.removeEventListener("pointermove",b)}},[]);let j={cursor:h};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{ref:m,"data-interactive-window":!0,className:o().resizable,style:j}),d&&(0,r.jsx)("div",{"data-interactive-window":!0,className:o()["resizing-mask"],style:j})]})};function d(e){let t=e.prompt,n=(0,i.useRef)(null),[s,c]=(0,i.useReducer)(e=>!e,!0);return((0,i.useEffect)(()=>{t&&c()},[t]),(0,i.useEffect)(()=>{n.current&&n.current.select()},[s]),t)?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:o()["action-overlay"],children:(0,r.jsxs)("div",{className:o()["action-container"],children:[(0,r.jsx)("span",{children:t.prompt}),(0,r.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),e.stopPropagation(),!t||!n.current)return;let r=n.current.value;t.resolve(r)},children:[(0,r.jsx)("input",{ref:n,type:"text",className:"system-text-input",defaultValue:t.defaultValue,required:!0}),(0,r.jsxs)("div",{className:o()["action-buttons"],children:[(0,r.jsx)("button",{className:"system-button",type:"button",onClick:()=>void(t&&t.reject("Prompt canceled by user")),children:"Cancel"}),(0,r.jsx)("button",{className:"system-button",type:"submit",children:"Ok"})]})]})]})})}):(0,r.jsx)(r.Fragment,{})}function l(e){let t=e.alert,n=(0,i.useRef)(null),[s,c]=(0,i.useReducer)(e=>!e,!0);return((0,i.useEffect)(()=>{t&&c()},[t]),(0,i.useEffect)(()=>{n.current&&n.current.focus()},[s]),t)?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:o()["action-overlay"],children:(0,r.jsxs)("div",{className:o()["action-container"],children:[(0,r.jsx)("span",{children:t.alert}),(0,r.jsx)("div",{className:o()["action-buttons"],children:(0,r.jsx)("button",{ref:n,className:"system-button",type:"submit",onClick:()=>void(t&&t.resolve()),children:"Ok"})})]})})}):(0,r.jsx)(r.Fragment,{})}function h(e){let t=e.action;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d,{prompt:(null==t?void 0:t.action)==="prompt"?t:null}),(0,r.jsx)(l,{alert:(null==t?void 0:t.action)==="alert"?t:null})]})}function f(e){let t,{window:n,WindowApp:s,windowCompositor:d}=e,l=(0,i.useRef)(!1);if(null===e.parent)return(0,r.jsx)(r.Fragment,{});let f=e.parent,w={position:"absolute",display:(t=n).minimized?"none":"block",top:"".concat(t.y,"px"),left:"".concat(t.x,"px"),width:"".concat(t.width,"px"),height:"".concat(t.height,"px"),zIndex:1e3+10*t.order},A=((e,t,n,s)=>{let[u,d]=(0,i.useState)(!1),[l,h]=(0,i.useState)(!1),f=e.application.apis,w=(0,i.useRef)(null),A=(0,i.useRef)(0),g=(0,i.useRef)(!1),m=(0,i.useRef)(new a),x=(0,i.useRef)({x:0,y:0,width:0,height:0}),p=[o().header];function v(){!1===s.current?(x.current={x:e.x,y:e.y,width:e.width,height:e.height},e.x=0,e.y=0,e.width=n.offsetWidth,e.height=n.offsetHeight,t.update(e),t.focus(e.id)):(e.x=x.current.x,e.y=x.current.y,e.width=x.current.width,e.height=x.current.height,t.update(e)),s.current=!s.current}function y(){A.current=0}function b(n){if(n.target!==w.current)return void y();window.addEventListener("pointermove",j),window.addEventListener("pointerup",_),function(){if(null===A.current)return;let e=Date.now();e-A.current<1e3?(v(),y()):A.current=e}();let r=w.current.parentNode.parentNode.parentNode;d(!0),g.current=!0;let i=r.getBoundingClientRect(),s=n.clientY-i.y;m.current.offset.y=s,m.current.offset.x=0,e.focused||t.focus(e.id),m.current.cursor={x:n.clientX,y:n.clientY},m.current.window={x:e.x,y:e.y,width:e.width,height:e.height}}function j(r){if(!g.current)return;s.current=!1,y();let i=m.current.cursor,o=m.current.window,a=(0,c.qE)(r.clientX,n.offsetLeft,n.offsetWidth),u=(0,c.qE)(r.clientY,n.offsetTop+m.current.offset.y,n.offsetHeight+m.current.offset.y),d=i.x-a,l=i.y-u,h=o.x-d,f=o.y-l;e.x=h,e.y=Math.max(f,0),t.update(e)}function _(e){window.removeEventListener("pointermove",j),window.removeEventListener("pointerup",_),d(!1),g.current=!1}function E(e){h(e.isMobileDevice())}return l&&p.push(o().mobile),e.focused&&p.push(o().focused),(0,i.useEffect)(()=>{let e=w.current;if(null===e)return;let t=f.screen.subscribe(E),n=f.screen.getResolution();return n&&E(n),e.addEventListener("pointerdown",b),()=>{t(),e.removeEventListener("pointerdown",b)}},[]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{ref:w,"data-interactive-window":!0,className:p.join(" "),children:[(0,r.jsx)("span",{className:o()["header-title"],children:e.title}),(0,r.jsx)("div",{className:o().lines}),(0,r.jsxs)("div",{className:o()["header-buttons"],children:[(0,r.jsx)("button",{className:"header-button",onClick:()=>{t.minimize(e.id)},children:(0,r.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAYAAABy6+R8AAAAAXNSR0IArs4c6QAAAC5JREFUKJFjYBh+gBFK/ydFDyMShxiNjMg2EaOREYNBQCMjTg4OjbjUENQ4lAAAsBUGBRYmg2IAAAAASUVORK5CYII=",alt:"Minimize window",draggable:!1})}),(0,r.jsx)("button",{className:"header-button",onClick:v,children:(0,r.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAYAAABy6+R8AAAAAXNSR0IArs4c6QAAADBJREFUKJFjYBhZ4D8uCUYiNGCowaYJmw2MODn4nISsFlkTPg0o6mGaiNGAzaLBCACuAwYFQV/6vgAAAABJRU5ErkJggg==",alt:"Maximize window",draggable:!1})}),(0,r.jsx)("button",{className:"header-button",onClick:()=>{t.close(e.id)},children:(0,r.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAYAAABy6+R8AAAAAXNSR0IArs4c6QAAAEhJREFUKJFjYKAA/IdiotQwYZHApQEOGHFI4BVHlsSmAKtB6JpwOZERJwefkwhpImgTvtDDFRiUhR5eP6DLozsPV8DgEiceAADT2BMJIsMZOQAAAABJRU5ErkJggg==",alt:"Close window",draggable:!1})})]})]}),u&&(0,r.jsx)("div",{className:o()["dragging-mask"]})]})})(n,d,f,l),g=n.focused?o().focused:"",m="".concat(o()["content-container"]," ").concat(g),x={id:n.id};return(0,r.jsx)("div",{style:w,"data-window-root":"true",children:(0,r.jsxs)("div",{className:o().container,children:[!n.focused&&(0,r.jsx)("div",{onPointerDown:function(){d.focus(n.id)},className:o()["focus-layer"]}),n.focused&&(0,r.jsx)(u,{windowData:n,windowCompositor:d,parent:f,isMaximized:l}),(0,r.jsxs)("div",{className:m,children:[A,(0,r.jsxs)("div",{className:o().content,children:[(0,r.jsx)(h,{action:n.action}),(0,r.jsx)(s,{application:n.application,args:n.args,windowContext:x})]})]})]})})}}}]);