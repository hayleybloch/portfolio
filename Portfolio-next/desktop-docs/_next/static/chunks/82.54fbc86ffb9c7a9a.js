(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[11,82],{3082:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>v});var r=n(6029),i=n(5729),o=n(4011),l=n(6269),c=n.n(l),u=n(1502),a=n(4523),s=n(4842),d=n(9733);function f(e,t){t.endsWith("/")||(t+="/");let n=e.apis.fileSystem.getNode(t);return n.ok?"directory"!==n.value.kind?(0,a._)(Error("node type is not a directory")):(0,a.Ok)(n.value):n}function v(e){let{application:t,args:n,windowContext:l}=e,[a,v]=(0,i.useState)(n),[h,p]=(0,i.useState)(!1),[m,y]=(0,i.useState)([]),[x,w]=(0,i.useState)(!1),b=e.application.apis,{t:g}=(0,d.Bd)("common"),_=t.apis.fileSystem,k=(0,i.useRef)(null),E=(0,i.useRef)(new u.sW);function j(e){k.current&&E.current.cutOff(k.current),k.current=E.current.append(e)}function F(){return!!k.current&&null!==k.current.prev}function N(){return!!k.current&&null!==k.current.next}function L(e){y(function(e){let t="directory"===e.kind?e:e.parent,n=[];for(;t;)n.push(t),t=t.parent;for(let e=0;e<Math.floor(n.length/2);e++){let t=n.length-1-e,r=n[t];n[t]=n[e],n[e]=r}return n}(e));let n=(0,s.tG)(e);p(e.editable||e.editableContent);let r=t.compositor.getById(l.id);r&&(r.title="".concat(n," - File Manager"),t.compositor.update(r)),v(n)}function C(e){w(e.isMobileDevice())}function T(e){let n=f(t,e);n.ok&&(L(n.value),j(n.value))}(0,i.useEffect)(()=>{let e=f(t,a),n=b.screen.subscribe(C),r=b.screen.getResolution();return r&&C(r),e.ok&&(L(e.value),j(e.value)),()=>{n(),k.current=null,E.current=new u.sW}},[]);let R=x?c().mobile:"",D=m.map((e,t)=>(0,r.jsx)(i.Fragment,{children:(0,r.jsx)("button",{className:["system-button",c().breadcrumb].join(" "),onClick:()=>{t!==m.length-1&&(L(e),j(e))},children:e.name})},t));return(0,r.jsx)("div",{className:c().container,children:(0,r.jsxs)("div",{className:c().content,children:[(0,r.jsxs)("div",{className:c().locations,children:[(0,r.jsxs)("div",{className:c().header,children:[(0,r.jsx)("button",{className:["system-button spritesheet-btn",c()["header-left"]].join(" "),disabled:!F(),onClick:()=>(function(){if(!F())return;let e=k.current.prev;k.current=e,L(e.value)})(),children:(0,r.jsx)("div",{className:["spritesheet-btn-icon",c()["icon-prev"]].join(" ")})}),(0,r.jsx)("button",{className:["system-button spritesheet-btn",c()["header-left"]].join(" "),disabled:!N(),onClick:()=>(function(){if(!N())return;let e=k.current.next;k.current=e,L(e.value)})(),children:(0,r.jsx)("div",{className:["spritesheet-btn-icon",c()["icon-next"]].join(" ")})}),(0,r.jsx)("button",{className:["system-button spritesheet-btn",c()["header-right"]].join(" "),disabled:!h,onClick:()=>(function(){if(!h)return;let e=_.getDirectory(a);if(!e.ok)return;let n=g("filesystem.new_directory"),r=(0,s.Q1)(e.value,n),i=()=>{};t.compositor.prompt(l.id,g("finder.create_directory_instructions"),r).then(n=>{if(_.getDirectory("".concat(a).concat(n)).ok)return void t.compositor.alert(l.id,g("finder.create_directory_duplicated_name")).catch(i);_.addDirectory(e.value,n,!0,!0),_.propagateNodeEvent(e.value,{kind:"update"})}).catch(i)})(),children:(0,r.jsx)("div",{className:["spritesheet-btn-icon",c()["icon-create-directory"]].join(" ")})}),(0,r.jsx)("button",{className:["system-button spritesheet-btn",c()["header-right"]].join(" "),disabled:!h,onClick:()=>(function(){if(!h)return;let e=_.getDirectory(a);if(!e.ok)return;let n=g("filesystem.new_file"),r=(0,s.Q1)(e.value,n),i=()=>{};t.compositor.prompt(l.id,g("finder.create_text_file_instructions"),r).then(n=>{if(_.getNode("".concat(a).concat(n,".txt")).ok)return void t.compositor.alert(l.id,g("finder.create_text_file_duplicated_name")).catch(i);_.addTextFile(e.value,n,"",!0),_.propagateNodeEvent(e.value,{kind:"update"})}).catch(i)})(),children:(0,r.jsx)("div",{className:["spritesheet-btn-icon",c()["icon-create-file"]].join(" ")})})]}),g("finder.favorites"),(0,r.jsxs)("ul",{children:[(0,r.jsx)("li",{children:(0,r.jsx)("button",{className:"system-button ".concat(c()["navigation-btn"]," ").concat(R),onClick:()=>{T("/Applications/")},children:"Applications"})}),(0,r.jsx)("li",{children:(0,r.jsx)("button",{className:"system-button ".concat(c()["navigation-btn"]," ").concat(R),onClick:()=>{T("/Users/hayley/")},children:"Home"})}),(0,r.jsx)("li",{children:(0,r.jsx)("button",{className:"system-button ".concat(c()["navigation-btn"]," ").concat(R),onClick:()=>{T("/Users/hayley/Desktop/")},children:"Desktop"})}),(0,r.jsx)("li",{children:(0,r.jsx)("button",{className:"system-button ".concat(c()["navigation-btn"]," ").concat(R),onClick:()=>{T("/Users/hayley/Documents")},children:"Documents"})})]})]}),(0,r.jsxs)("div",{className:c().folder,children:[(0,r.jsx)("div",{className:c().path,children:D}),(0,r.jsx)(o.default,{directory:a,apis:t.apis,onFileOpen:function(e,n){if("directory"===e.kind)L(e),n||j(e);else{let n=(0,s.tG)(e);t.on({kind:"finder-open-file-event",path:n},l)}},allowOverflow:!0})]})]})})}},4011:(e,t,n)=>{"use strict";n.r(t),n.d(t,{FolderView:()=>x,default:()=>w});var r=n(6029),i=n(7117),o=n(5729),l=n(1024),c=n.n(l),u=n(8806),a=n.n(u),s=n(3019),d=n(9918),f=n(1502),v=n(373),h=n(4893),p=n(4523),m=n(4842);let y=c()(()=>Promise.resolve().then(n.bind(n,3019)),{loadableGenerated:{webpack:()=>[3019]}});function x(e){let{directory:t,apis:n,onFileOpen:l,localIconPosition:c,allowOverflow:u}=e,x=n.fileSystem,w=null!=c&&c,[b,g]=(0,o.useState)([]),_=(0,o.useRef)(new f.sW);function k(e){_.current=e,g(e.toArray())}let E=(0,o.useRef)(null),j=(0,o.useRef)(null),F=n.dragAndDrop,N=(0,o.useRef)(t),L=(0,o.useRef)({x:0,y:0}),C=(0,o.useRef)(!1),T=(0,o.useRef)({file:null,timestamp:0}),R=(0,o.useRef)({x:0,y:0}),D=(0,o.useRef)(),V=(0,o.useRef)([]),B=(0,o.useRef)(),H=(0,o.useRef)(null),[X,I]=(0,o.useState)({open:!1,x:0,y:0,width:0,height:0});function O(e){let t=E.current.getBoundingClientRect();return{x:e.x-t.left,y:e.y-t.top}}function M(e,t){return t.scrollLeft+e}function Y(e,t){return t.scrollTop+e}function S(e,t){return{x:M(e.x,t),y:Y(e.y,t)}}function W(e){let t=_.current,n=L.current;if(!j.current)return;let r=j.current,i=O(e),o={x:Math.min(n.x,i.x),y:Math.min(n.y,i.y)},l={x:Math.max(n.x,i.x),y:Math.max(n.y,i.y)},c={x1:M(o.x,r),x2:M(l.x,r),y1:Y(o.y,r),y2:Y(l.y,r)};for(let e of t.iterFromHead()){let t=e.value,n=(0,s.FolderIconHitBox)(t);t.selected=(0,d.fh)(c,n)}k(t)}function A(e){if(!j.current)return;let t=j.current.scrollLeft,n=j.current.scrollTop,r=Math.abs(R.current.x-e.clientX-t),i=Math.abs(R.current.y-e.clientY-n),o=D.current;if(!o)return;let l={nodes:V.current.map(e=>{let t={x:o.x-e.x,y:o.y-e.y};return{item:e.entry.node,position:{x:0,y:0},offset:t}})};if((r>5||i>5)&&!C.current&&(C.current=!0,H.current=F.start(l,e.clientX-2*t,e.clientY-2*n)),C.current&&H.current){H.current.move(e.clientX-2*t,e.clientY-2*n);let r=document.elementsFromPoint(e.clientX,e.clientY),i=null;for(let e of r){if(e.hasAttribute("data-drop-point")){i=e;break}if(e.hasAttribute("data-window-root"))break}if(!i){B.current=void 0;return}let o=i.getBoundingClientRect();for(let t of l.nodes)t.position={x:e.clientX-o.left-t.offset.x,y:e.clientY-o.top-t.offset.y};let u=new CustomEvent(v.CH,{detail:l,bubbles:!1});if(null==i||i.dispatchEvent(u),i!==B.current){var c;let e=new CustomEvent(v.JD,{detail:l,bubbles:!1}),t=new CustomEvent(v.iP,{detail:l,bubbles:!1});null==(c=B.current)||c.dispatchEvent(t),null==i||i.dispatchEvent(e),B.current=i}}}function q(e){var t,n,r;window.removeEventListener("pointermove",A),window.removeEventListener("pointerup",q);let i=null==(t=B.current)?void 0:t.getBoundingClientRect(),o=D.current;if(!o||!i){null==(r=H.current)||r.drop(e.clientX,e.clientY);return}if(B.current){let t={nodes:V.current.map(t=>{let n={x:o.x-t.x,y:o.y-t.y},r={x:e.clientX-i.left-n.x,y:e.clientY-i.top-n.y};return{item:t.entry.node,position:r,offset:n}})},n=new CustomEvent(v._L,{detail:t,bubbles:!1});B.current.dispatchEvent(n)}null==(n=H.current)||n.drop(e.clientX,e.clientY),H.current=null,B.current=void 0,C.current=!1}function G(){for(let e of _.current.iterFromTail())e.value.editing.active&&(x.renameNode(e.value.entry.node,e.value.editing.value),e.value.editing.active=!1)}function P(e){if(e.preventDefault(),e.touches.length>1)return;let t=e.touches[0];Q({x:t.clientX,y:t.clientY},"touch")}function J(e){"touch"!==e.pointerType&&Q({x:e.clientX,y:e.clientY},"pointer")}function Q(e,t){if(!E.current||!j.current)return;let n=function(e){let t=_.current;if(!j.current)return;let n=j.current,r=S(O(e),n);for(let e of t.iterFromTail()){let t=e.value,n=(0,s.FolderIconHitBox)(t),i=(0,d.R2)(r,n);if(i>=0)return{iconEntry:e.value,clickedOnTheIcon:0===i}}}(e);if(n){var r,i,o;let t=j.current.getBoundingClientRect();D.current={x:e.x-t.left-j.current.scrollLeft,y:e.y-t.top-j.current.scrollTop},n.iconEntry.selected||(G(),function(e){let t=_.current;if(!j.current)return;let n=j.current,r=S(O(e),n),i=!1;for(let e of t.iterFromHead()){let n=e.value,o=(0,s.FolderIconHitBox)(n),l=(0,d.JT)(r,o)&&!i;n.selected=l,l&&(t.moveToHead(e),i=!0)}k(t)}(e));let c=_.current;window.addEventListener("pointermove",A),window.addEventListener("pointerup",q);let u=[];for(let e of c.iterFromTail()){let t=e.value;t.selected&&u.push(t)}V.current=u,R.current={x:e.x,y:e.y};let a=(null==(r=T.current.file)?void 0:r.iconEntry)===n.iconEntry,f=(null==(i=T.current.file)?void 0:i.clickedOnTheIcon)===n.clickedOnTheIcon,v=n.clickedOnTheIcon;a&&v?(G(),l(n.iconEntry.entry.node,!1),T.current={file:null,timestamp:0}):a&&f&&!v?((o=n.iconEntry).entry.node.editable&&(o.editing={active:!0,value:o.entry.node.name,onSave:()=>{G()}},k(_.current)),T.current={file:null,timestamp:0}):T.current={file:n,timestamp:Date.now()}}else G(),D.current=void 0,function(e,t){switch(L.current=O(e),t){case"pointer":window.addEventListener("pointermove",U),window.addEventListener("pointerup",K);break;case"touch":window.addEventListener("touchmove",Z),window.addEventListener("touchend",$)}}(e,t)}function U(e){"touch"!==e.pointerType&&z({x:e.clientX,y:e.clientY})}function Z(e){let t=e.touches[0];z({x:t.clientX,y:t.clientY})}function z(e){let t=L.current,n=O(e),r={x:Math.min(t.x,n.x),y:Math.min(t.y,n.y)},i={x:Math.max(t.x,n.x),y:Math.max(t.y,n.y)},o=r.x,l=r.y;I({open:!0,x:o,y:l,width:i.x-r.x,height:i.y-r.y}),W(e)}function K(e){"touch"!==e.pointerType&&ee({x:e.clientX,y:e.clientY},"pointer")}function $(e){if(e.touches.length>0)return;let t=e.changedTouches[0];ee({x:t.clientX,y:t.clientY},"touch")}function ee(e,t){switch(W(e),X.open=!1,I(X),t){case"pointer":window.removeEventListener("pointermove",U),window.removeEventListener("pointerup",K);break;case"touch":window.removeEventListener("touchmove",Z),window.removeEventListener("touchend",$)}}function et(e){let t=_.current;!function(e,t){var n;let r=new Set,i=null!=(n=t.detail.nodes[0])?n:null;if(i){for(let e of t.detail.nodes)r.add(e.item.id);for(let t of e.iterFromTail()){let e=t.value,n=e.entry.node;if(r.has(n.id))continue;if("directory"!==n.kind){e.selected=!1;continue}let o=(0,s.FolderIconHitBox)(e),l={x:i.position.x+i.offset.x,y:i.position.y+i.offset.y};e.selected=(0,d.JT)(l,o)}}}(t,e),k(t)}function en(e){let t=_.current,n=new Map;if(!E.current)return;let r=E.current,o=function(e,t){var n;let r=new Set,i=null!=(n=t.detail.nodes[0])?n:null,o=x.getDirectory(N.current);if(!o.ok)return(0,p._)(Error("Unable to lookup currentDirectory"));if(!i)return(0,p.Ok)(o.value);for(let e of t.detail.nodes)r.add(e.item.id);for(let t of e.iterFromTail()){let e=t.value.entry.node;if("directory"!==e.kind||r.has(e.id))continue;let n=(0,s.FolderIconHitBox)(t.value),o={x:i.position.x+i.offset.x,y:i.position.y+i.offset.y};if((0,d.JT)(o,n))return(0,p.Ok)(e)}return(0,p.Ok)(o.value)}(t,e);if(!o.ok)return;let l=(0,m.tG)(o.value)===N.current,c=!l,u=r.getBoundingClientRect(),a={min:-s.IconWidth/2,max:u.width-s.IconWidth/2},f={min:-s.IconHeight/2,max:u.height-s.IconHeight/2};e:for(let r of e.detail.nodes){let e,u;if(r.item.parent&&r.item.parent.id!==o.value.id){let e=r.item.parent;n.set(e.id,e),c=!0}let s=l?[]:o.value.children.toArray(),d=x.moveNode(r.item,o.value);if(!d.ok)continue;let v=d.value;if(l)e=(0,h.qE)(r.position.x,a.min,a.max),u=(0,h.qE)(r.position.y,f.min,f.max);else{let t=(0,i.aE)(o.value.settings,o.value.content,s);e=t.x,u=t.y}w||(v.x=e,v.y=u);let p={entry:v,x:e,y:u,selected:!1,dragging:!1,editing:{active:!1,value:r.item.name}};for(let e of t.iterFromTail())if(e.value.entry.node.id===v.node.id){e.value=p;continue e}t.append(p)}c?(n.forEach(e=>x.propagateNodeEvent(e,{kind:"update"})),x.propagateNodeEvent(o.value,{kind:"update"})):(w||x.propagateNodeEvent(o.value,{kind:"refresh"}),k(t))}function er(){if(w||!j.current||!N.current)return;let e=x.getDirectory(N.current);if(!e.ok)return;let t=j.current,n=t.scrollWidth,r=t.scrollHeight;e.value.content.width=n,e.value.content.height=r}(0,o.useEffect)(()=>{if(!E.current)return;let e=E.current;e.addEventListener("touchstart",P,{passive:!1}),e.addEventListener("pointerdown",J,{passive:!1}),e.addEventListener(v.CH,et),e.addEventListener(v._L,en);let t=new ResizeObserver(er);return t.observe(E.current),er(),()=>{e.removeEventListener("touchstart",P),e.removeEventListener("pointerdown",J),e.removeEventListener(v.CH,et),e.removeEventListener(v._L,en),t.disconnect()}},[]),(0,o.useEffect)(()=>{let e=function(e){let t=t=>(function(e,t){if("rename"===t.kind){let e=x.getDirectory(t.path);return e.ok&&l(e.value,!0),null}let n=x.getDirectory(e);if(!n.ok)return null;if(N.current=(0,m.tG)(n.value),w)!function(e,t){if("refresh"===t.kind||!E.current)return;let n=E.current,r=_.current,o=new Map,l=new f.sW,c=[];for(let e of r.iterFromTail()){let t=e.value,n=t.entry.node.id;o.set(n,t)}for(let t of e.children.iterFromTail()){let e=o.get(t.value.node.id);if(!e){c.push(t.value);continue}l.append({entry:t.value,selected:!1,dragging:!1,x:e.x,y:e.y,editing:{active:!1,value:t.value.node.name}})}let u={view:"icons",width:n.clientWidth,height:n.clientHeight,overflowBehavior:"overlay"};for(let e of c){let t={alwaysOpenAsIconView:!1,sortBy:null,sortDirection:"vertical",sortOrigin:"top-right"},n=(0,i.aE)(t,u,l.toArray());l.append({entry:e,selected:!1,dragging:!1,x:n.x,y:n.y,editing:{active:!1,value:e.node.name}})}k(l)}(n.value,t);else{var r=n.value;let e=new f.sW;for(let t of r.children.iterFromTail())e.append({entry:t.value,selected:!1,dragging:!1,x:t.value.x,y:t.value.y,editing:{active:!1,value:t.value.node.name}});k(e)}return n.value})(e,t),n=t({kind:"update"});if(n)return x.subscribe(n,t)}(t);return er(),()=>{e&&e()}},[t]);let ei=b.map((e,t)=>(0,r.jsx)(y,{folderIconEntry:e,index:t},t)),eo=X.open?(0,r.jsx)("div",{className:a()["selection-box"],style:{width:X.width,height:X.height,top:X.y,left:X.x}}):(0,r.jsx)(r.Fragment,{});return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{ref:E,className:a().folder,"data-drop-point":"true",children:[(0,r.jsx)("div",{className:a()["selection-box-container"],children:eo}),(0,r.jsx)("div",{ref:j,className:[a()["icons-container"],!(null==u||u)?a()["hide-overflow"]:""].join(" "),children:ei})]})})}let w=x},6269:e=>{e.exports={container:"FinderView_container__qLLXO",locations:"FinderView_locations__HWpgh",header:"FinderView_header__whC5A",content:"FinderView_content__qqjW3",path:"FinderView_path__DFPEo",breadcrumb:"FinderView_breadcrumb__BBn8w",folder:"FinderView_folder__1i3CR","icon-prev":"FinderView_icon-prev__wfawj","icon-next":"FinderView_icon-next__3BBba","icon-create-file":"FinderView_icon-create-file__4mfNk","icon-create-directory":"FinderView_icon-create-directory__klZiS","header-left":"FinderView_header-left__dPQfL","header-right":"FinderView_header-right__4sezm","navigation-btn":"FinderView_navigation-btn__1Xqt8",mobile:"FinderView_mobile__86Qv8"}},8806:e=>{e.exports={folder:"FolderView_folder__lD1mg","selection-box":"FolderView_selection-box__723Zg","icons-container":"FolderView_icons-container__48W0g","hide-overflow":"FolderView_hide-overflow__AD36X","selection-box-container":"FolderView_selection-box-container__pEZi_"}}}]);